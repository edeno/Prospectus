### Specific [Aim \#3](#aim3): To build web-enabled interactive visualization tools that enhance exploratory analysis, checking of raw data and statistical modeling assumptions, and data presentation for large, complex and multi-scale electrophyisological data. {#aim3}
Our approach is to create building blocks for interactive visualizations that can be extended to more complicated visualizations, linked together to provide an integrated view of an electrophysiological dataset --- from raw data to statistical summary or from cellular to circuit level --- or used independently. Each visualization allows for examination of the electrophysiological signals (or summary statistic of the signal) over time relative to task-relevant events, comparison of different subjects or recording sessions, and aggregation of signals over regions-of-interest such as anatomically defined brain areas.

All visualizations will be built in JavaScript using the [D3](http://d3js.org/) library [@bostock_d3_2011] --- a visualization library for translating data into web elements. The D3 library includes support for adding interactions, animations and manipulating data, which is crucial to building the visualizations. This library is well supported and under active development.

All code will be uploaded and documented in a [Github software repository](https://github.com/edeno) and available under the [GNU General Public License, version 2 ](http://www.gnu.org/licenses/old-licenses/gpl-2.0.en.html)--- ensuring that future use and development of the code will remain open source and shareable.

The first visualization we will build incorporates the most canonical visualizations for single and multiunit spiking data --- the raster plot and peri-event time histogram. The raster plot describes spike times for each trial relative to a trial event. The peri-event time histogram is a simple but useful summary of how, over a series of trials, the spike times are distributed across time bins defined relative to the time of a trial event. Because these two types of visualizations are canonical, familiar and represent the "raw" spiking data, they are an ideal building-block visualization. They can also be used to compare raw data to generated data from models for checking of model assumptions (posterior predictive checks). Our visualization will allow for dynamic sorting by task factors so that they can easily be compared to coefficients from the generalized linear models.

We also will build an interactive visualization for the generalized linear models that will: (1) show the relationship between the multiple dimensions of the model fit over time, (2) show the relationship between multiple models, and (3) show the relationship between multiple brain areas. To show the relationship between multiple dimensions, we will use the parallel coordinate plots [@wegman_hyperdimensional_1990].

Finally, we will build an interactive visualization aimed at capturing functional connectivity between neurons/electrodes. Functional network analysis is a growing area of neuroscience research, driven in part by technological improvements allowing us to record from more sensors simultaneously. However, as researchers record from more sensors, network analyses can become unwieldy and hard to interpret, because the number of possible network connections scales quadratically with the number of sensors (e.g. electrodes). Further, we expect neural processes to form dynamic networks that vary over time, frequency, and spatial scales (e.g. within and between brain regions), adding complexity to network analyses. While careful statistical modeling and strong hypotheses are important for yielding interpretable results, interactive visualizations are a neglected tool for coping with high-dimensional analyses.

We present an interactive web-based visualization application, SpectraVis, that: (1) displays task-related functional networks over time and frequency, (2) compares individual and associative measures on sensor pairs (e.g. spectra, coherences), (3) compares different measures of association (e.g. correlation vs. coherence, binary vs. weighted networks), and (4) views networks at two spatial scales (sensor- and region-of-interest-level). The different modules of SpectraVis are dynamically linked, highlighting relationships between the metrics in response to user interaction.

A working example of SpectraVis[^1] can be found [online][2][^2] and the code is accessible on [Github][3][^3]. [@fig:figure3] shows a typical view of SpectraVis. The network view shows the anatomical location of the sensors (circles with sensor number) and edges (lines) weighted by the edge statistic. In this example, the edges are binary, representing significant changes in local field potential coherence between *Speech* --- subjects reading aloud the words of the Gettysburg Address --- and *Silence* at a particular frequency (10 Hz) and time (187.5 ms after speech onset)[^4]. The network has dense connectivity within and between primary motor and primary somatosensory cortices (M1 and S1). The controls can be used to play a movie of the network over time, showing increased connectivity starting within M1 300 ms before speech onset and spreading to S1 100 ms before speech onset.  Below the network view is a sensor view (dotted box) which depicts the relationship (spectra, coherences) between a selected pair of sensors (circled in black, network view, sensors 85 and 90) at all times and frequencies. Here, the edge between M1 (sensor 90) and S1 (sensor 85) represents a 10 Hz increase in speech coherence relative to silence. The increase co-occurs with higher frequency beta (15-25Hz) power suppression on the M1 sensor. Mousing over these displays updates the network view to the time-frequency bin under the cursor.

![A static screenshot of the SpectraVis interface with the ECOG overt reading data.](figures/Figure3.png){#fig:figure3}

#### Potential Pitfalls
A challenge for building software tools is making them easy enough to install and use while making them flexible enough to account for a variety of use cases. Our solution to this is to try to set smart defaults so that the visualization can run without much alteration and to provide extensive documentation and examples via the Github repository for the project. Additionally, we provide Matlab scripts that can help organize data into the correct format.
